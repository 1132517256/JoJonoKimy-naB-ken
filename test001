-- AUTOPICKUP + MISC + ESP + ESP DIOSES + ESP ITEMS IMPORTANTES + ESP METEOR CORE
-- + CAMERA NOCLIP + NOCLIP PUERTAS + SPEED CFRAME + TP DIMENSIONES + EXTRAS ESP DIOSES MAPA

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Autopickup Aspiradora",
    LoadingTitle = "Cargando...",
    LoadingSubtitle = "by Tu Script",
    ShowText = "v1.0",
    Theme = "Default"
})

local AutopickupTab = Window:CreateTab("Autopickup", 0)
local MiscTab      = Window:CreateTab("Misc", 0)
local BlackHoleTab = Window:CreateTab("el oyo negro", 0)
local ExtrasTab    = Window:CreateTab("extras", 0)

-- Servicios
local rs = game:GetService("ReplicatedStorage")
local Modules = rs:WaitForChild("Modules")
local Packets = require(Modules:WaitForChild("Packets"))
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local player = Players.LocalPlayer

local ITEMS_FOLDER = workspace:WaitForChild("Items")
local PICKUP_DISTANCE = 25

-- PlaceIds
local MAIN_PLACE_ID      = 11729688377
local DIMENSION_PLACE_ID = 11879754496
local STORY_PLACE_ID     = 18596007812
local TRADE_PLACE_ID     = 71090798546210
local BOSS_PLACE_ID      = 114178392375273

-- Estados
local pickupActive = false
local pickupLoop = nil

local deleteItemsActive = false
local deleteItemsLoop = nil

local espActive = false
local espLoop = nil

local godEspActive = false
local godEspLoop = nil

local itemsEspActive = false
local itemsEspLoop = nil

local meteorEspActive = false
local meteorEspLoop = nil

local cameraNoclipActive = false
local cameraNoclipLoop = nil

local doorNoclipActive = false

local speedCFrameActive = false
local speedValue = 0.2080
local baseSpeedFactor = 0.2080

-- ESP dioses en workspace.Resources
local mapGodsEspActive = false
local mapGodsEspLoop = nil

local playersWithESP = {}
local playersWithGodESP = {}

-- LISTA DE ITEMS CON FILTRO AUTOPICKUP
local itemFilters = {
    ["Emerald"] = true,
    ["Coal"] = true,
    ["Crystal Chunk"] = true,
    ["Pink Diamond"] = true,
    ["Raw Gold"] = true,
    ["Adurite"] = true,
    ["Gold"] = true,
    ["Iron"] = true,
    ["Spirit Key"] = true,
    ["Steel"] = true,
    ["Magnetite"] = true,
    ["Essence"] = true,
    ["Bloodfruit"] = true,
    ["Coin2"] = true,
    ["Void Shard"] = true, -- NUEVO ITEM AUTOPICK
}

-- ITEMS IMPORTANTES PARA ESP
local importantItemNames = {
    ["Gold"] = true,
    ["Crystal Chunk"] = true,
}

-- Nombres de dioses en workspace.Resources para ESP extra
local mapGodNames = {
    ["Ancient God"]   = true,
    ["Furious God"]   = true,
    ["Hateful God"]   = true,
    ["Lonely God"]    = true,
    ["Miserable God"] = true,
    ["Old God"]       = true,
    ["Sleeping God"]  = true,
    ["Wealthy God"]   = true,
    ["Dark God"]      = true,
    ["Infinity God"]  = true,
    ["Magical God"]   = true,
    ["Odd God"]       = true,
    ["Strange God"]   = true,
}

local function getDistance(a, b)
    return (a.Position - b.Position).Magnitude
end

local function getTeamColor(otherPlayer)
    if otherPlayer.Team then
        return otherPlayer.Team.TeamColor.Color
    end
    return Color3.fromRGB(255, 255, 255)
end

-- ================= AUTOPICKUP =================

local function startPickupLoop()
    if pickupLoop then task.cancel(pickupLoop) end
    
    pickupLoop = task.spawn(function()
        while pickupActive do
            task.wait(0.1)

            local char = player.Character
            if not char then continue end

            local hrp = char:FindFirstChild("HumanoidRootPart")
            if not hrp then continue end

            for _, item in ipairs(ITEMS_FOLDER:GetChildren()) do
                if not itemFilters[item.Name] then continue end
                
                local part = item:IsA("BasePart") and item or item:FindFirstChildWhichIsA("BasePart", true)
                if not part then continue end

                if getDistance(hrp, part) <= PICKUP_DISTANCE then
                    local entityId = item:GetAttribute("EntityID")
                    if entityId then
                        pcall(function()
                            Packets.Pickup.send(entityId)
                        end)
                    end
                end
            end
        end
    end)
end

-- ================= DELETE ITEMS =================

local function startDeleteItemsLoop()
    if deleteItemsLoop then task.cancel(deleteItemsLoop) end
    
    deleteItemsLoop = task.spawn(function()
        while deleteItemsActive do
            task.wait(0.2)
            
            for _, item in ipairs(ITEMS_FOLDER:GetChildren()) do
                pcall(function()
                    item:Destroy()
                end)
            end
        end
    end)
end

-- ================= ESP NORMAL JUGADORES =================

local function startESP()
    if espLoop then task.cancel(espLoop) end
    playersWithESP = {}
    
    espLoop = task.spawn(function()
        while espActive do
            task.wait(0.1)
            
            for _, otherPlayer in ipairs(Players:GetPlayers()) do
                if otherPlayer ~= player then
                    local character = otherPlayer.Character
                    if character then
                        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                        local humanoid = character:FindFirstChild("Humanoid")
                        
                        if humanoidRootPart and humanoid then
                            local teamColor = getTeamColor(otherPlayer)
                            
                            local highlight = character:FindFirstChild("ESP_Highlight")
                            
                            if not highlight then
                                highlight = Instance.new("Highlight")
                                highlight.Name = "ESP_Highlight"
                                highlight.Adornee = character
                                highlight.FillColor = teamColor
                                highlight.OutlineColor = teamColor
                                highlight.FillTransparency = 0.7
                                highlight.OutlineTransparency = 0.3
                                highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                                highlight.Parent = character
                            else
                                highlight.FillColor = teamColor
                                highlight.OutlineColor = teamColor
                            end
                            
                            local billboardGui = character:FindFirstChild("ESP_Label")
                            
                            if not billboardGui then
                                billboardGui = Instance.new("BillboardGui")
                                billboardGui.Name = "ESP_Label"
                                billboardGui.Adornee = humanoidRootPart
                                billboardGui.Size = UDim2.new(0, 120, 0, 40)
                                billboardGui.StudsOffset = Vector3.new(0, 3, 0)
                                billboardGui.MaxDistance = math.huge
                                billboardGui.AlwaysOnTop = true
                                
                                local textLabel = Instance.new("TextLabel")
                                textLabel.Name = "PlayerInfo"
                                textLabel.Size = UDim2.new(1, 0, 1, 0)
                                textLabel.BackgroundTransparency = 1
                                textLabel.TextColor3 = teamColor
                                textLabel.TextSize = 12
                                textLabel.Font = Enum.Font.GothamBold
                                textLabel.TextStrokeTransparency = 0.3
                                textLabel.TextScaled = false
                                textLabel.Parent = billboardGui
                                
                                billboardGui.Parent = character
                            end
                            
                            local label = billboardGui:FindFirstChild("PlayerInfo")
                            if label then
                                label.Text = otherPlayer.Name .. " - " .. math.floor(humanoid.Health) .. "HP"
                                label.TextColor3 = teamColor
                            end
                            
                            playersWithESP[otherPlayer.UserId] = true
                        end
                    end
                end
            end
        end
    end)
end

local function stopESP()
    if espLoop then task.cancel(espLoop) end
    
    task.wait(0.1)
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "ESP_Highlight" or obj.Name == "ESP_Label" then
            pcall(function() obj:Destroy() end)
        end
    end
    
    playersWithESP = {}
    print("✅ ESP eliminado completamente")
end

-- ================= ESP DIOSES (player gear) =================

local function playerHasGodGear(plr)
    local wsPlayers = workspace:FindFirstChild("Players")
    if not wsPlayers then return false end
    
    local charFolder = wsPlayers:FindFirstChild(plr.Name)
    if not charFolder then return false end
    
    local hasLegs  = charFolder:FindFirstChild("God Legs")
    local hasChest = charFolder:FindFirstChild("God Chestplate")
    local hasHalo  = charFolder:FindFirstChild("God Halo")
    
    return (hasLegs ~= nil) or (hasChest ~= nil) or (hasHalo ~= nil)
end

local function startGodESP()
    if godEspLoop then task.cancel(godEspLoop) end
    playersWithGodESP = {}
    
    godEspLoop = task.spawn(function()
        while godEspActive do
            task.wait(0.15)
            
            for _, otherPlayer in ipairs(Players:GetPlayers()) do
                if otherPlayer ~= player then
                    local character = otherPlayer.Character
                    if character and playerHasGodGear(otherPlayer) then
                        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                        local humanoid = character:FindFirstChild("Humanoid")
                        
                        if humanoidRootPart and humanoid then
                            local teamColor = Color3.fromRGB(255, 215, 0)
                            
                            local highlight = character:FindFirstChild("GOD_ESP_Highlight")
                            if not highlight then
                                highlight = Instance.new("Highlight")
                                highlight.Name = "GOD_ESP_Highlight"
                                highlight.Adornee = character
                                highlight.FillColor = teamColor
                                highlight.OutlineColor = teamColor
                                highlight.FillTransparency = 0.5
                                highlight.OutlineTransparency = 0.1
                                highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                                highlight.Parent = character
                            else
                                highlight.FillColor = teamColor
                                highlight.OutlineColor = teamColor
                            end
                            
                            local billboardGui = character:FindFirstChild("GOD_ESP_Label")
                            if not billboardGui then
                                billboardGui = Instance.new("BillboardGui")
                                billboardGui.Name = "GOD_ESP_Label"
                                billboardGui.Adornee = humanoidRootPart
                                billboardGui.Size = UDim2.new(0, 150, 0, 45)
                                billboardGui.StudsOffset = Vector3.new(0, 4, 0)
                                billboardGui.MaxDistance = math.huge
                                billboardGui.AlwaysOnTop = true
                                
                                local textLabel = Instance.new("TextLabel")
                                textLabel.Name = "GodPlayerInfo"
                                textLabel.Size = UDim2.new(1, 0, 1, 0)
                                textLabel.BackgroundTransparency = 1
                                textLabel.TextColor3 = teamColor
                                textLabel.TextSize = 13
                                textLabel.Font = Enum.Font.GothamBold
                                textLabel.TextStrokeTransparency = 0.2
                                textLabel.TextScaled = false
                                textLabel.Parent = billboardGui
                                
                                billboardGui.Parent = character
                            end
                            
                            local label = billboardGui:FindFirstChild("GodPlayerInfo")
                            if label then
                                label.Text = "[DIOS] " .. otherPlayer.Name .. " - " .. math.floor(humanoid.Health) .. "HP"
                                label.TextColor3 = teamColor
                            end
                            
                            playersWithGodESP[otherPlayer.UserId] = true
                        end
                    end
                end
            end
        end
    end)
end

local function stopGodESP()
    if godEspLoop then task.cancel(godEspLoop) end
    task.wait(0.1)
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "GOD_ESP_Highlight" or obj.Name == "GOD_ESP_Label" then
            pcall(function() obj:Destroy() end)
        end
    end
    
    playersWithGodESP = {}
    print("✅ ESP DIOSES eliminado completamente")
end

-- ================= ESP ITEMS IMPORTANTES =================

local function getItemHighlightColor(name)
    if name == "Gold" then
        return Color3.fromRGB(255, 215, 0)
    elseif name == "Crystal Chunk" then
        return Color3.fromRGB(0, 255, 255)
    else
        return Color3.fromRGB(255, 255, 255)
    end
end

local function startItemsESP()
    if itemsEspLoop then task.cancel(itemsEspLoop) end
    
    itemsEspLoop = task.spawn(function()
        while itemsEspActive do
            task.wait(0.15)
            
            for _, item in ipairs(ITEMS_FOLDER:GetChildren()) do
                if importantItemNames[item.Name] then
                    local part = item:IsA("BasePart") and item or item:FindFirstChildWhichIsA("BasePart", true)
                    if part then
                        local highlight = part:FindFirstChild("ITEM_ESP_Highlight")
                        local color = getItemHighlightColor(item.Name)
                        
                        if not highlight then
                            highlight = Instance.new("Highlight")
                            highlight.Name = "ITEM_ESP_Highlight"
                            highlight.Adornee = part
                            highlight.FillColor = color
                            highlight.OutlineColor = color
                            highlight.FillTransparency = 0.6
                            highlight.OutlineTransparency = 0.1
                            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                            highlight.Parent = part
                        else
                            highlight.FillColor = color
                            highlight.OutlineColor = color
                        end
                        
                        local billboardGui = part:FindFirstChild("ITEM_ESP_Label")
                        
                        if not billboardGui then
                            billboardGui = Instance.new("BillboardGui")
                            billboardGui.Name = "ITEM_ESP_Label"
                            billboardGui.Adornee = part
                            billboardGui.Size = UDim2.new(0, 120, 0, 30)
                            billboardGui.StudsOffset = Vector3.new(0, 2.5, 0)
                            billboardGui.MaxDistance = math.huge
                            billboardGui.AlwaysOnTop = true
                            
                            local textLabel = Instance.new("TextLabel")
                            textLabel.Name = "ItemInfo"
                            textLabel.Size = UDim2.new(1, 0, 1, 0)
                            textLabel.BackgroundTransparency = 1
                            textLabel.TextColor3 = color
                            textLabel.TextSize = 12
                            textLabel.Font = Enum.Font.GothamBold
                            textLabel.TextStrokeTransparency = 0.3
                            textLabel.TextScaled = false
                            textLabel.Parent = billboardGui
                            
                            billboardGui.Parent = part
                        end
                        
                        local label = billboardGui:FindFirstChild("ItemInfo")
                        if label then
                            label.Text = item.Name
                            label.TextColor3 = color
                        end
                    end
                end
            end
        end
    end)
end

local function stopItemsESP()
    if itemsEspLoop then task.cancel(itemsEspLoop) end
    
    task.wait(0.1)
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "ITEM_ESP_Highlight" or obj.Name == "ITEM_ESP_Label" then
            pcall(function() obj:Destroy() end)
        end
    end
    
    print("✅ ESP Items Importantes eliminado completamente")
end

-- ================= ESP METEOR CORE + CRYSTAL METEOR CORE =================

local function startMeteorESP()
    if meteorEspLoop then task.cancel(meteorEspLoop) end
    
    meteorEspLoop = task.spawn(function()
        while meteorEspActive do
            task.wait(0.2)
            
            local function handleMeteor(obj)
                if not obj then return end
                if not (obj:IsA("BasePart") or obj:IsA("Model")) then return end
                
                local adornee = obj
                if obj:IsA("Model") then
                    adornee = obj:FindFirstChildWhichIsA("BasePart", true) or obj
                end
                if not adornee then return end
                
                local highlight = adornee:FindFirstChild("METEOR_ESP_Highlight")
                
                if not highlight then
                    highlight = Instance.new("Highlight")
                    highlight.Name = "METEOR_ESP_Highlight"
                    highlight.Adornee = adornee
                    highlight.FillColor = Color3.fromRGB(255, 100, 100)
                    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0.1
                    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                    highlight.Parent = adornee
                end
                
                local billboardGui = adornee:FindFirstChild("METEOR_ESP_Label")
                
                if not billboardGui then
                    billboardGui = Instance.new("BillboardGui")
                    billboardGui.Name = "METEOR_ESP_Label"
                    billboardGui.Adornee = adornee
                    billboardGui.Size = UDim2.new(0, 140, 0, 35)
                    billboardGui.StudsOffset = Vector3.new(0, 4, 0)
                    billboardGui.MaxDistance = math.huge
                    billboardGui.AlwaysOnTop = true
                    
                    local textLabel = Instance.new("TextLabel")
                    textLabel.Name = "MeteorInfo"
                    textLabel.Size = UDim2.new(1, 0, 1, 0)
                    textLabel.BackgroundTransparency = 1
                    textLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
                    textLabel.TextSize = 13
                    textLabel.Font = Enum.Font.GothamBold
                    textLabel.TextStrokeTransparency = 0.2
                    textLabel.TextScaled = false
                    textLabel.Text = obj.Name
                    textLabel.Parent = billboardGui
                    
                    billboardGui.Parent = adornee
                else
                    local lbl = billboardGui:FindFirstChild("MeteorInfo")
                    if lbl then lbl.Text = obj.Name end
                end
            end
            
            handleMeteor(workspace:FindFirstChild("Meteor Core"))
            handleMeteor(workspace:FindFirstChild("Crystal Meteor Core"))
        end
    end)
end

local function stopMeteorESP()
    if meteorEspLoop then task.cancel(meteorEspLoop) end
    
    task.wait(0.1)
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "METEOR_ESP_Highlight" or obj.Name == "METEOR_ESP_Label" then
            pcall(function() obj:Destroy() end)
        end
    end
    
    print("✅ ESP Meteor Cores eliminado completamente")
end

-- ================= ESP DIOSES MAPA (workspace.Resources) =================

local function startMapGodsESP()
    if mapGodsEspLoop then task.cancel(mapGodsEspLoop) end
    
    mapGodsEspLoop = task.spawn(function()
        while mapGodsEspActive do
            task.wait(0.3)
            
            local resources = workspace:FindFirstChild("Resources")
            if not resources then continue end
            
            for _, inst in ipairs(resources:GetChildren()) do
                if mapGodNames[inst.Name] then
                    local adornee = inst
                    if inst:IsA("Model") then
                        adornee = inst:FindFirstChildWhichIsA("BasePart", true) or inst
                    end
                    if not adornee then continue end
                    
                    local highlight = adornee:FindFirstChild("MAP_GOD_ESP_Highlight")
                    if not highlight then
                        highlight = Instance.new("Highlight")
                        highlight.Name = "MAP_GOD_ESP_Highlight"
                        highlight.Adornee = adornee
                        highlight.FillColor = Color3.fromRGB(150, 0, 255)
                        highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
                        highlight.FillTransparency = 0.5
                        highlight.OutlineTransparency = 0.1
                        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                        highlight.Parent = adornee
                    end
                    
                    local billboardGui = adornee:FindFirstChild("MAP_GOD_ESP_Label")
                    if not billboardGui then
                        billboardGui = Instance.new("BillboardGui")
                        billboardGui.Name = "MAP_GOD_ESP_Label"
                        billboardGui.Adornee = adornee
                        billboardGui.Size = UDim2.new(0, 160, 0, 35)
                        billboardGui.StudsOffset = Vector3.new(0, 5, 0)
                        billboardGui.MaxDistance = math.huge
                        billboardGui.AlwaysOnTop = true
                        
                        local textLabel = Instance.new("TextLabel")
                        textLabel.Name = "MapGodInfo"
                        textLabel.Size = UDim2.new(1, 0, 1, 0)
                        textLabel.BackgroundTransparency = 1
                        textLabel.TextColor3 = Color3.fromRGB(200, 150, 255)
                        textLabel.TextSize = 13
                        textLabel.Font = Enum.Font.GothamBold
                        textLabel.TextStrokeTransparency = 0.2
                        textLabel.TextScaled = false
                        textLabel.Text = inst.Name
                        textLabel.Parent = billboardGui
                        
                        billboardGui.Parent = adornee
                    else
                        local lbl = billboardGui:FindFirstChild("MapGodInfo")
                        if lbl then lbl.Text = inst.Name end
                    end
                end
            end
        end
    end)
end

local function stopMapGodsESP()
    if mapGodsEspLoop then task.cancel(mapGodsEspLoop) end
    mapGodsEspLoop = nil
    
    task.wait(0.1)
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "MAP_GOD_ESP_Highlight" or obj.Name == "MAP_GOD_ESP_Label" then
            pcall(function() obj:Destroy() end)
        end
    end
    print("✅ ESP Dioses Mapa eliminado completamente")
end

-- ================= CAMERA NOCLIP (Deployables) =================

local function setDeployablesTransparency(makeTransparent)
    local deployables = workspace:FindFirstChild("Deployables")
    if not deployables then return end
    
    for _, part in ipairs(deployables:GetDescendants()) do
        if part:IsA("BasePart") then
            if makeTransparent then
                if part:GetAttribute("OriginalTransparency") == nil then
                    part:SetAttribute("OriginalTransparency", part.Transparency)
                end
                part.Transparency = 0.8
            else
                local original = part:GetAttribute("OriginalTransparency")
                if original ~= nil then
                    part.Transparency = original
                    part:SetAttribute("OriginalTransparency", nil)
                end
            end
        end
    end
end

local function startCameraNoclip()
    cameraNoclipActive = true
    
    if cameraNoclipLoop then
        task.cancel(cameraNoclipLoop)
        cameraNoclipLoop = nil
    end
    
    setDeployablesTransparency(true)
    
    cameraNoclipLoop = task.spawn(function()
        while cameraNoclipActive do
            task.wait(1.5)
            setDeployablesTransparency(true)
        end
    end)
    
    print("✅ Camera Noclip ACTIVADO")
end

local function stopCameraNoclip()
    cameraNoclipActive = false
    
    if cameraNoclipLoop then
        task.cancel(cameraNoclipLoop)
        cameraNoclipLoop = nil
    end
    
    setDeployablesTransparency(false)
    print("❌ Camera Noclip DESACTIVADO")
end

-- ================= NOCLIP PUERTAS =================

local function setDoorsNoclip(enabled)
    local deployables = workspace:FindFirstChild("Deployables")
    if not deployables then
        print("⚠️ No existe workspace.Deployables")
        return
    end

    local doorsFound = 0

    for _, dep in ipairs(deployables:GetChildren()) do
        for _, obj in ipairs(dep:GetDescendants()) do
            if obj:IsA("BasePart") and obj.Name == "Door" then
                if enabled then
                    if obj:GetAttribute("OriginalDoorCollide") == nil then
                        obj:SetAttribute("OriginalDoorCollide", obj.CanCollide)
                    end
                    if obj:GetAttribute("OriginalDoorTransparency") == nil then
                        obj:SetAttribute("OriginalDoorTransparency", obj.Transparency)
                    end
                    obj.CanCollide = false
                    obj.Transparency = 0.8
                else
                    local oc = obj:GetAttribute("OriginalDoorCollide")
                    local ot = obj:GetAttribute("OriginalDoorTransparency")
                    if oc ~= nil then
                        obj.CanCollide = oc
                        obj:SetAttribute("OriginalDoorCollide", nil)
                    end
                    if ot ~= nil then
                        obj.Transparency = ot
                        obj:SetAttribute("OriginalDoorTransparency", nil)
                    end
                end
                doorsFound += 1
            end
        end

        for _, obj in ipairs(dep:GetDescendants()) do
            if obj:IsA("Model") and obj.Name == "Door" then
                for _, part in ipairs(obj:GetDescendants()) do
                    if part:IsA("BasePart") then
                        if enabled then
                            if part:GetAttribute("OriginalDoorCollide") == nil then
                                part:SetAttribute("OriginalDoorCollide", part.CanCollide)
                            end
                            if part:GetAttribute("OriginalDoorTransparency") == nil then
                                part:SetAttribute("OriginalDoorTransparency", part.Transparency)
                            end
                            part.CanCollide = false
                            part.Transparency = 0.8
                        else
                            local oc = part:GetAttribute("OriginalDoorCollide")
                            local ot = part:GetAttribute("OriginalDoorTransparency")
                            if oc ~= nil then
                                part.CanCollide = oc
                                part:SetAttribute("OriginalDoorCollide", nil)
                            end
                            if ot ~= nil then
                                part.Transparency = ot
                                part:SetAttribute("OriginalDoorTransparency", nil)
                            end
                        end
                        doorsFound += 1
                    end
                end
            end
        end
    end

    print((enabled and "✅ Noclip Puertas ACTIVADO, puertas tocadas: " or "❌ Noclip Puertas DESACTIVADO, puertas restauradas: ") .. doorsFound)
end

-- ================= SPEED CFRAME =================

RunService.RenderStepped:Connect(function(dt)
    if not speedCFrameActive then return end

    local char = player.Character
    if not char then return end

    local hrp = char:FindFirstChild("HumanoidRootPart")
    local hum = char:FindFirstChildOfClass("Humanoid")
    if not hrp or not hum then return end

    local moveDir = hum.MoveDirection
    if moveDir.Magnitude > 0 then
        local delta = moveDir.Unit * speedValue * baseSpeedFactor
        hrp.CFrame = hrp.CFrame + Vector3.new(delta.X, 0, delta.Z)
    end
end)

-- ============ AUTOPICKUP TAB ============

AutopickupTab:CreateToggle({
    Name = "Activar Autopickup",
    CurrentValue = false,
    Callback = function(Value)
        pickupActive = Value
        if pickupActive then
            startPickupLoop()
            print("✅ Autopickup ACTIVADO")
        else
            if pickupLoop then task.cancel(pickupLoop) end
            print("❌ Autopickup DESACTIVADO")
        end
    end,
})

AutopickupTab:CreateDivider()

for itemName, _ in pairs(itemFilters) do
    AutopickupTab:CreateToggle({
        Name = itemName,
        CurrentValue = true,
        Callback = function(Value)
            itemFilters[itemName] = Value
            print(itemName .. ": " .. (Value and "✅ ACTIVADO" or "❌ DESACTIVADO"))
        end,
    })
end

-- ============ MISC TAB ============

MiscTab:CreateToggle({
    Name = "Delete All Items",
    CurrentValue = false,
    Callback = function(Value)
        deleteItemsActive = Value
        if deleteItemsActive then
            startDeleteItemsLoop()
            print("✅ Delete All Items ACTIVADO")
        else
            if deleteItemsLoop then task.cancel(deleteItemsLoop) end
            print("❌ Delete All Items DESACTIVADO")
        end
    end,
})

MiscTab:CreateToggle({
    Name = "Player ESP",
    CurrentValue = false,
    Callback = function(Value)
        espActive = Value
        if espActive then
            startESP()
            print("✅ Player ESP ACTIVADO")
        else
            stopESP()
            print("❌ Player ESP DESACTIVADO")
        end
    end,
})

MiscTab:CreateToggle({
    Name = "ESP DIOSES",
    CurrentValue = false,
    Callback = function(Value)
        godEspActive = Value
        if godEspActive then
            startGodESP()
            print("✅ ESP DIOSES ACTIVADO")
        else
            stopGodESP()
            print("❌ ESP DIOSES DESACTIVADO")
        end
    end,
})

MiscTab:CreateToggle({
    Name = "ESP Items Importantes",
    CurrentValue = false,
    Callback = function(Value)
        itemsEspActive = Value
        if itemsEspActive then
            startItemsESP()
            print("✅ ESP Items Importantes ACTIVADO")
        else
            stopItemsESP()
            print("❌ ESP Items Importantes DESACTIVADO")
        end
    end,
})

MiscTab:CreateToggle({
    Name = "ESP Meteor Core",
    CurrentValue = false,
    Callback = function(Value)
        meteorEspActive = Value
        if meteorEspActive then
            startMeteorESP()
            print("✅ ESP Meteor Core(s) ACTIVADO")
        else
            stopMeteorESP()
            print("❌ ESP Meteor Core(s) DESACTIVADO")
        end
    end,
})

MiscTab:CreateToggle({
    Name = "Camera Noclip",
    CurrentValue = false,
    Callback = function(Value)
        if Value then
            startCameraNoclip()
        else
            stopCameraNoclip()
        end
    end,
})

MiscTab:CreateToggle({
    Name = "Noclip Puertas",
    CurrentValue = false,
    Callback = function(Value)
        doorNoclipActive = Value
        setDoorsNoclip(doorNoclipActive)
    end,
})

MiscTab:CreateToggle({
    Name = "Speed CFrame",
    CurrentValue = false,
    Callback = function(Value)
        speedCFrameActive = Value
        print(Value and "✅ Speed CFrame ACTIVADO" or "❌ Speed CFrame DESACTIVADO")
    end,
})

-- ============ TAB "EL OYO NEGRO" (TPs) ============

BlackHoleTab:CreateButton({
    Name = "TP a Dimensión (Voidness)",
    Callback = function()
        TeleportService:Teleport(DIMENSION_PLACE_ID, player)
    end,
})

BlackHoleTab:CreateButton({
    Name = "TP a Mundo Normal",
    Callback = function()
        TeleportService:Teleport(MAIN_PLACE_ID, player)
    end,
})

BlackHoleTab:CreateButton({
    Name = "TP a Modo Historia",
    Callback = function()
        TeleportService:Teleport(STORY_PLACE_ID, player)
    end,
})

BlackHoleTab:CreateButton({
    Name = "TP a Trade Plaza",
    Callback = function()
        TeleportService:Teleport(TRADE_PLACE_ID, player)
    end,
})

BlackHoleTab:CreateButton({
    Name = "TP a Bossfight",
    Callback = function()
        TeleportService:Teleport(BOSS_PLACE_ID, player)
    end,
})

-- ============ TAB "extras" (ESP dioses mapa) ============

ExtrasTab:CreateToggle({
    Name = "ESP Dioses del mapa",
    CurrentValue = false,
    Callback = function(Value)
        mapGodsEspActive = Value
        if mapGodsEspActive then
            startMapGodsESP()
            print("✅ ESP Dioses Mapa ACTIVADO")
        else
            stopMapGodsESP()
            print("❌ ESP Dioses Mapa DESACTIVADO")
        end
    end,
})

print("✅ Script cargado correctamente")
